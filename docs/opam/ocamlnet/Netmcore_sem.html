<!DOCTYPE HTML>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title> &ndash; OCaml</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google Web Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Domine:400,700" rel="stylesheet">
    <!-- Only part of Bootstrap that we don't load from a CDN is our own customized CSS build. -->
    <link href="/static/css/bootstrap.css" rel="stylesheet" media="screen">
    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->
    <script type="text/javascript">
      function octry(x){
        if(document.getElementById('buttons').innerHTML=='') {
          t = document.getElementById('tryocaml');
          js = document.createElement("script"); js.type = "text/javascript"; js.src = "/try-ocaml.js";
          t.appendChild(js);
        } else {
          t = document.getElementById('tryocaml');
          t.style.display = 'block';
          document.getElementById('console').value = x;
          document.getElementById('console').focus();
          document.getElementById('console').select();
        }
      }
    </script>

 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
 <script type="text/javascript" src="/docs/opam/doc_loader.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="/"><img src="/static/img/ocaml.png" alt="OCaml"></a>
          <div class="nav-collapse collapse">
                        <ul class="nav">
              <li ><a href="/learn/">Learn</a></li>
              <li ><a href="/docs/">Documentation</a></li>
              <li ><a href="/platform/">Platform</a></li>
              <li ><a href="/list.html">Packages</a></li>
              <li ><a href="/community/">Community</a></li>
            </ul>

            <form class="navbar-search pull-right">
              <input class="search-query" type="text" placeholder="Search" />
            </form>
          </div>
        </div>
      </div>
    </nav>
    
        <div class="container">
      <div class="row">



          <div id='main-contents' class="content">
            <div class="ocaml_toplevel_module"><div class="info">Semaphores</div>
<div class="info"><div class="info">Semaphores are here defined as values that reside in shared heaps
    (TODO reference : Netmcore_heap), for example in the header field of 
    TODO reference : Netmcore_array or somewhere else in heap-allocated
    data structures.<br/>    In order to ensure that the semaphore is in the heap, the
    special function <code class="code">create</code> must be used to initialize it
    there. As <code class="code">create</code> requires a mutator as argument, this is
    only possible by calling <code class="code">create</code> from the callback of
    TODO reference : Netmcore_heap.modify.<br/>    Semaphores are special values, and cannot be copied or moved.<br/>    Note that TODO reference : Netsys_posix provides wrappers for direct use
    of the semaphore functionality of the OS. These wrappers, however,
    cannot be used together with heaps, because semaphores are
    there represented as bigarrays, which cannot be pushed to heaps.
    This module here uses a trick to make it possible nevertheless.</div></div>
<pre><span class="TYPEsemaphore"><span class="keyword">type</span> semaphore</span> </pre>
<pre><span class="VALdummy"><span class="keyword">val</span> dummy</span> : <code class="type">unit -&gt; <a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a></code></pre><div class="info"><div class="info">A dummy semaphore is non-functional, but can be used to put something
      into <code class="code">semaphore</code>-typed variables</div></div>
<pre><span class="VALcreate"><span class="keyword">val</span> create</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netmcore_heap&amp;type=mutator">Netmcore_heap.mutator</a> -&gt; int -&gt; <a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a></code></pre><div class="info"><div class="info"><code class="code">create m value</code>: Creates a semaphore with initial <code class="code">value</code>, and
      pushes it to the heap, using the mutator <code class="code">m</code>.<br/>      After being pushed to the heap, the semaphore can be used. It is
      nonsense to copy it outside the heap.</div></div>
<pre><span class="VALdestroy"><span class="keyword">val</span> destroy</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a> -&gt; unit</code></pre><div class="info"><div class="info">Destroys the semaphore</div></div>
<pre><span class="VALgetvalue"><span class="keyword">val</span> getvalue</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a> -&gt; int</code></pre><div class="info"><div class="info">Returns the value of the semaphore</div></div>
<pre><span class="VALpost"><span class="keyword">val</span> post</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a> -&gt; unit</code></pre><div class="info"><div class="info">Increments the semaphore by one, and notifies one of the waiting
      processes.</div></div>
<pre><span class="VALwait"><span class="keyword">val</span> wait</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netmcore_sem&amp;type=semaphore">semaphore</a> -&gt; <a href="?package=ocamlnet&amp;module=Netsys_posix&amp;type=sem_wait_behavior">Netsys_posix.sem_wait_behavior</a> -&gt; unit</code></pre><div class="info"><div class="info">Decrements the semaphore by one. Semaphores cannot become negative.
      If the semaphore is already 0, the wait behavior defines how to go
      on:<ul><li>TODO reference : Netsys_posix.SEM_WAIT_BLOCK: Wait until the semaphore is
        posted</li><li>TODO reference : Netsys_posix.SEM_WAIT_NONBLOCK: Raise <code class="code">EAGAIN</code></li></ul>      Waiting is restarted after running a signal handler.</div></div>
</div>
          </div>
        </div>
      </div>
    </div>
    <footer id="footer" class="navbar navbar-inverse navbar-fixed-bottom">
      <div class="navbar-inner">
        <div class="container-fluid">
          <ul class="nav pull-right">
            <li><a href="#">Feedback</a></li>
            <li><a href="#">Contact us</a></li>
            <li><a href="#">Find us on GitHub</a></li>
          </ul>
        </div>
      </div>
    </footer>
    <!-- Load javascript from CDN -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script>octry('')</script>
  </body>
</html>

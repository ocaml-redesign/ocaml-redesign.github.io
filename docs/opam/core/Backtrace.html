<!DOCTYPE HTML>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title> &ndash; OCaml</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google Web Fonts -->
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Domine:400,700" rel="stylesheet">
    <!-- Only part of Bootstrap that we don't load from a CDN is our own customized CSS build. -->
    <link href="/static/css/bootstrap.css" rel="stylesheet" media="screen">
    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->

 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
 <script type="text/javascript" src="/docs/opam/doc_loader.js"></script>
    <script type="text/javascript">
      function octry(x){
        if(document.getElementById('buttons').innerHTML=='') {
          t = document.getElementById('tryocaml');
          js = document.createElement("script"); js.type = "text/javascript"; js.src = "/try-ocaml.js";
          t.appendChild(js);
        } else {
          t = document.getElementById('tryocaml');
          t.style.display = 'block';
          document.getElementById('console').value = x;
          document.getElementById('console').focus();
          document.getElementById('console').select();
        }
      }
      if(!(document.getElementById('buttons'))) octry = function() {}
    </script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="/"><img src="/static/img/ocaml.png" alt="OCaml"></a>
          <div class="nav-collapse collapse">
                        <ul class="nav">
              <li ><a href="/learn/">Learn</a></li>
              <li ><a href="/docs/">Documentation</a></li>
              <li ><a href="/platform/">Platform</a></li>
              <li ><a href="/list.html">Packages</a></li>
              <li ><a href="/community/">Community</a></li>
            </ul>

            <form class="navbar-search pull-right">
              <input class="search-query" type="text" placeholder="Search" />
            </form>
          </div>
        </div>
      </div>
    </nav>
    
        <div class="container">
      <div class="row">



          <div id='main-contents' class="content">
            <div class="ocaml_toplevel_module"><div class="info">Dealing with stack backtraces.<br/>    The <code class="code">Backtrace</code> module deals with two different kinds of backtraces:<br/>    1. snapshots of the stack obtained on demand (<code class="code">Backtrace.get</code>)
    2. the stack frames unwound when an exception is raised (<code class="code">Backtrace.Exn</code>)</div>
<pre><span class="TYPEt"><span class="keyword">type</span> t</span> </pre><div class="info"><div class="info">A <code class="code">Backtrace.t</code> is a snapshot of the stack obtained by calling <code class="code">Backtrace.get</code>.  It is
    represented as a string with newlines separating the frames.  <code class="code">sexp_of_t</code> splits the
    string at newlines and removes some of the cruft, leaving a human-friendly list of
    frames, but <code class="code">to_string</code> does not.</div></div>
<pre><span class="VALget"><span class="keyword">val</span> get</span> : <code class="type">(unit -&gt; <a href="?package=core&amp;module=Backtrace&amp;type=t">t</a>) Core_kernel.Std.Or_error.t</code></pre>
<pre><span class="VALget_opt"><span class="keyword">val</span> get_opt</span> : <code class="type">unit -&gt; <a href="?package=core&amp;module=Backtrace&amp;type=t">t</a> option</code></pre><div class="info"><div class="info"><code class="code">get_opt ()</code> returns a backtrace if <code class="code">get</code> is implemented.</div></div>
<pre><span class="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type"><a href="?package=core&amp;module=Backtrace&amp;type=t">t</a> -&gt; string</code></pre>
<div class="ocaml_module sig" name="Exn"><pre><span class="keyword">module</span> <a href="?package=core&amp;module=Backtrace.Exn">Exn</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code><div class="info"><div class="info"><code class="code">Backtrace.Exn</code> has functions for controlling and printing the backtrace of the most
    recently raised exception.<br/>    When an exception is raised, the runtime &quot;unwinds&quot; the stack, i.e. removes stack
    frames, until it reaches a frame with an exception handler.  It then matches the
    exception against the patterns in the handler.  If the exception matches, then the
    program continues.  If not, then the runtime continues unwinding the stack to the
    next handler.<br/>    If <code class="code">am_recording () = true</code>, then the runtime, while it is unwinding the stack, keeps
    track of the part of the stack that is unwound.  This is available as a human-readable
    string via <code class="code">most_recent ()</code>.  Calling <code class="code">most_recent</code> if <code class="code">am_recording () = false</code> will
    yield the empty string.<br/>    With <code class="code">am_recording () = true</code>, OCaml keeps only a backtrace for the most recently
    raised exception.  When one raises an exception, OCaml checks if it is physically
    equal to the most recently raised exception.  If they are equal, then OCaml appends
    the string representation of the stack unwound by the current raise to the stored
    backtrace.  If the exception being raised is not physically equally to the most
    recently raised exception, then OCaml starts recording a new backtrace.  Thus one must
    call <code class="code">most_recent</code> before a subsequent <code class="code">raise</code> of a (physically) distinct exception,
    or the backtrace is lost.<br/>    The initial value of <code class="code">am_recording ()</code> is determined by the setting of the
    environment variable OCAMLRUNPARAM.  If OCAMLRUNPARAM is set, then <code class="code">am_recording ()
    = true</code> iff the character &quot;b&quot; occurs in OCAMLRUNPARAM.  If OCAMLRUNPARAM is not set,
    then <code class="code">am_recording ()</code> is initially true.<br/>    This is the same functionality as provided by the OCaml stdlib <code class="code">Printexc</code> functions
    <code class="code">backtrace_status</code>, <code class="code">record_backtraces</code>, <code class="code">get_backtrace</code>.</div></div></pre><div class="ocaml_module_content">
<pre><span class="VALam_recording"><span class="keyword">val</span> am_recording</span> : <code class="type">unit -&gt; bool</code></pre>
<pre><span class="VALset_recording"><span class="keyword">val</span> set_recording</span> : <code class="type">bool -&gt; unit</code></pre>
<pre><span class="VALmost_recent"><span class="keyword">val</span> most_recent</span> : <code class="type">unit -&gt; string</code></pre><div class="info"><div class="info"><code class="code">most_recent ()</code> returns a string containing the stack that was unwound by the
      most recently raised exception.</div></div></div></div>
<pre><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="?package=core&amp;module=Backtrace&amp;type=t">t</a> -&gt; Sexplib.Sexp.t</code></pre>
<div class="info"><div class="info"><code class="code">get_opt ()</code> returns a backtrace if <code class="code">get</code> is implemented.</div></div>
<div class="info"><div class="info"><code class="code">Backtrace.Exn</code> has functions for controlling and printing the backtrace of the most
    recently raised exception.<br/>    When an exception is raised, the runtime &quot;unwinds&quot; the stack, i.e. removes stack
    frames, until it reaches a frame with an exception handler.  It then matches the
    exception against the patterns in the handler.  If the exception matches, then the
    program continues.  If not, then the runtime continues unwinding the stack to the
    next handler.<br/>    If <code class="code">am_recording () = true</code>, then the runtime, while it is unwinding the stack, keeps
    track of the part of the stack that is unwound.  This is available as a human-readable
    string via <code class="code">most_recent ()</code>.  Calling <code class="code">most_recent</code> if <code class="code">am_recording () = false</code> will
    yield the empty string.<br/>    With <code class="code">am_recording () = true</code>, OCaml keeps only a backtrace for the most recently
    raised exception.  When one raises an exception, OCaml checks if it is physically
    equal to the most recently raised exception.  If they are equal, then OCaml appends
    the string representation of the stack unwound by the current raise to the stored
    backtrace.  If the exception being raised is not physically equally to the most
    recently raised exception, then OCaml starts recording a new backtrace.  Thus one must
    call <code class="code">most_recent</code> before a subsequent <code class="code">raise</code> of a (physically) distinct exception,
    or the backtrace is lost.<br/>    The initial value of <code class="code">am_recording ()</code> is determined by the setting of the
    environment variable OCAMLRUNPARAM.  If OCAMLRUNPARAM is set, then <code class="code">am_recording ()
    = true</code> iff the character &quot;b&quot; occurs in OCAMLRUNPARAM.  If OCAMLRUNPARAM is not set,
    then <code class="code">am_recording ()</code> is initially true.<br/>    This is the same functionality as provided by the OCaml stdlib <code class="code">Printexc</code> functions
    <code class="code">backtrace_status</code>, <code class="code">record_backtraces</code>, <code class="code">get_backtrace</code>.</div></div>
<div class="info"><div class="info"><code class="code">most_recent ()</code> returns a string containing the stack that was unwound by the
      most recently raised exception.</div></div>
</div>
          </div>
        </div>
      </div>
    </div>
    <footer id="footer" class="navbar navbar-inverse navbar-fixed-bottom">
      <div class="navbar-inner">
        <div class="container-fluid">
          <ul class="nav pull-right">
            <li><a href="#">Feedback</a></li>
            <li><a href="#">Contact us</a></li>
            <li><a href="#">Find us on GitHub</a></li>
          </ul>
        </div>
      </div>
    </footer>
    <!-- Load javascript from CDN -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script>octry('')</script>
  </body>
</html>
